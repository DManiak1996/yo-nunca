{
  "url": "https://nextjs.org/docs/app/guides/local-development",
  "title": "How to optimize your local development environment",
  "content": "Next.js is designed to provide a great developer experience. As your application grows, you might notice slower compilation times during local development. This guide will help you identify and fix common compile-time performance issues.\n\nThe development process with next dev is different than next build and next start.\n\nnext dev compiles routes in your application as you open or navigate to them. This enables you to start the dev server without waiting for every route in your application to compile, which is both faster and uses less memory. Running a production build applies other optimizations, like minifying files and creating content hashes, which are not needed for local development.\n\nAntivirus software can slow down file access. While this is more common on Windows machines, this can be an issue for any system with an antivirus tool installed.\n\nOn Windows, you can add your project to the Microsoft Defender Antivirus exclusion list.\n\nOn macOS, you can disable Gatekeeper inside of your terminal.\n\nIf you or your employer have configured any other Antivirus solutions on your system, you should inspect the relevant settings for those products.\n\nMake sure you're using the latest version of Next.js. Each new version often includes performance improvements.\n\nTurbopack is now the default bundler for Next.js development and provides significant performance improvements over webpack.\n\nIf you need to use Webpack instead of Turbopack, you can opt-in:\n\nLearn more about Turbopack. See our upgrade guides and codemods for more information.\n\nThe way you import code can greatly affect compilation and bundling time. Learn more about optimizing package bundling and explore tools like Dependency Cruiser or Madge.\n\nLibraries like @material-ui/icons, @phosphor-icons/react, or react-icons can import thousands of icons, even if you only use a few. Try to import only the icons you need:\n\nYou can often find what import pattern to use in the documentation for the icon library you're using. This example follows @phosphor-icons/react recommendation.\n\nLibraries like react-icons includes many different icon sets. Choose one set and stick with that set.\n\nFor example, if your application uses react-icons and imports all of these:\n\nCombined they will be tens of thousands of modules that the compiler has to handle, even if you only use a single import from each.\n\n\"Barrel files\" are files that export many items from other files. They can slow down builds because the compiler has to parse them to find if there are side-effects in the module scope by using the import.\n\nTry to import directly from specific files when possible. Learn more about barrel files and the built-in optimizations in Next.js.\n\nNext.js can automatically optimize imports for certain packages. If you are using packages that utilize barrel files, add them to your next.config.js:\n\nTurbopack automatically analyzes imports and optimizes them. It does not require this configuration.\n\nIf you're using Tailwind CSS, make sure it's set up correctly.\n\nA common mistake is configuring your content array in a way which includes node_modules or other large directories of files that should not be scanned.\n\nTailwind CSS version 3.4.8 or newer will warn you about settings that might slow down your build.\n\nIn your tailwind.config.js, be specific about which files to scan:\n\nAvoid scanning unnecessary files:\n\nIf you've added custom webpack settings, they might be slowing down compilation.\n\nConsider if you really need them for local development. You can optionally only include certain tools for production builds, or explore using the default Turbopack bundler and configuring loaders instead.\n\nIf your app is very large, it might need more memory.\n\nLearn more about optimizing memory usage.\n\nChanges to Server Components cause the entire page to re-render locally in order to show the new changes, which includes fetching new data for the component.\n\nThe experimental serverComponentsHmrCache option allows you to cache fetch responses in Server Components across Hot Module Replacement (HMR) refreshes in local development. This results in faster responses and reduced costs for billed API calls.\n\nLearn more about the experimental option.\n\nIf you're using Docker for development on Mac or Windows, you may experience significantly slower performance compared to running Next.js locally.\n\nDocker's filesystem access on Mac and Windows can cause Hot Module Replacement (HMR) to take seconds or even minutes, while the same application runs with fast HMR when developed locally.\n\nThis performance difference is due to how Docker handles filesystem operations outside of Linux environments. For the best development experience:\n\nLearn more about Docker deployment for production use.\n\nUse the logging.fetches option in your next.config.js file, to see more detailed information about what's happening during development:\n\nLearn more about fetch logging.\n\nTurbopack tracing is a tool that helps you understand the performance of your application during local development. It provides detailed information about the time taken for each module to compile and how they are related.\n\nMake sure you have the latest version of Next.js installed.\n\nGenerate a Turbopack trace file:\n\nNavigate around your application or make edits to files to reproduce the problem.\n\nStop the Next.js development server.\n\nA file called trace-turbopack will be available in the .next/dev folder.\n\nYou can interpret the file using npx next internal trace [path-to-file]:\n\nOn versions where trace is not available, the command was named turbo-trace-server:\n\nOnce the trace server is running you can view the trace at https://trace.nextjs.org/.\n\nBy default the trace viewer will aggregate timings, in order to see each individual time you can switch from \"Aggregated in order\" to \"Spans in order\" at the top right of the viewer.\n\nGood to know: The trace file is place under the development server directory, which defaults to .next/dev. This is controllable using the isolatedDevBuild flag in your Next config file.\n\nShare the trace file generated in the Turbopack Tracing section and share it on GitHub Discussions or Discord.",
  "headings": [
    {
      "level": "h1",
      "text": "How to optimize your local development environment",
      "id": ""
    },
    {
      "level": "h2",
      "text": "Local dev vs. production",
      "id": "local-dev-vs-production"
    },
    {
      "level": "h2",
      "text": "Improving local dev performance",
      "id": "improving-local-dev-performance"
    },
    {
      "level": "h3",
      "text": "1. Check your computer's antivirus",
      "id": "1-check-your-computers-antivirus"
    },
    {
      "level": "h3",
      "text": "2. Update Next.js and use Turbopack",
      "id": "2-update-nextjs-and-use-turbopack"
    },
    {
      "level": "h3",
      "text": "3. Check your imports",
      "id": "3-check-your-imports"
    },
    {
      "level": "h4",
      "text": "Icon libraries",
      "id": "icon-libraries"
    },
    {
      "level": "h4",
      "text": "Barrel files",
      "id": "barrel-files"
    },
    {
      "level": "h4",
      "text": "Optimize package imports",
      "id": "optimize-package-imports"
    },
    {
      "level": "h3",
      "text": "4. Check your Tailwind CSS setup",
      "id": "4-check-your-tailwind-css-setup"
    },
    {
      "level": "h3",
      "text": "5. Check custom webpack settings",
      "id": "5-check-custom-webpack-settings"
    },
    {
      "level": "h3",
      "text": "6. Optimize memory usage",
      "id": "6-optimize-memory-usage"
    },
    {
      "level": "h3",
      "text": "7. Server Components and data fetching",
      "id": "7-server-components-and-data-fetching"
    },
    {
      "level": "h3",
      "text": "8. Consider local development over Docker",
      "id": "8-consider-local-development-over-docker"
    },
    {
      "level": "h2",
      "text": "Tools for finding problems",
      "id": "tools-for-finding-problems"
    },
    {
      "level": "h3",
      "text": "Detailed fetch logging",
      "id": "detailed-fetch-logging"
    },
    {
      "level": "h3",
      "text": "Turbopack tracing",
      "id": "turbopack-tracing"
    },
    {
      "level": "h3",
      "text": "Still having problems?",
      "id": "still-having-problems"
    }
  ],
  "code_samples": [
    {
      "code": "npm install next@latest\nnpm run dev  # Turbopack is used by default",
      "language": "unknown"
    },
    {
      "code": "npm run dev --webpack",
      "language": "unknown"
    },
    {
      "code": "// Instead of this:\nimport { TriangleIcon } from '@phosphor-icons/react'\n \n// Do this:\nimport { TriangleIcon } from '@phosphor-icons/react/dist/csr/Triangle'",
      "language": "python"
    },
    {
      "code": "module.exports = {\n  experimental: {\n    optimizePackageImports: ['package-name'],\n  },\n}",
      "language": "unknown"
    },
    {
      "code": "module.exports = {\n  content: [\n    './src/**/*.{js,ts,jsx,tsx}', // Good\n    // This might be too broad\n    // It will match `packages/**/node_modules` too\n    // '../../packages/**/*.{js,ts,jsx,tsx}',\n  ],\n}",
      "language": "unknown"
    },
    {
      "code": "module.exports = {\n  content: [\n    // Better - only scans the 'src' folder\n    '../../packages/ui/src/**/*.{js,ts,jsx,tsx}',\n  ],\n}",
      "language": "unknown"
    },
    {
      "code": "module.exports = {\n  logging: {\n    fetches: {\n      fullUrl: true,\n    },\n  },\n}",
      "language": "unknown"
    },
    {
      "code": "NEXT_TURBOPACK_TRACING=1 npm run dev",
      "language": "unknown"
    },
    {
      "code": "npx next internal trace .next/dev/trace-turbopack",
      "language": "unknown"
    },
    {
      "code": "npx next internal turbo-trace-server .next/dev/trace-turbopack",
      "language": "unknown"
    }
  ],
  "patterns": [],
  "links": [
    "https://nextjs.org/docs/app",
    "https://nextjs.org/docs/app/guides",
    "https://nextjs.org/docs/app/guides/local-development",
    "https://nextjs.org/docs/app/guides/upgrading",
    "https://nextjs.org/docs/app/guides/package-bundling",
    "https://nextjs.org/docs/app/api-reference/config/next-config-js/turbopack",
    "https://nextjs.org/docs/app/guides/memory-usage",
    "https://nextjs.org/docs/app/api-reference/config/next-config-js/serverComponentsHmrCache",
    "https://nextjs.org/docs/app/getting-started/deploying",
    "https://nextjs.org/docs/app/api-reference/config/next-config-js/logging",
    "https://nextjs.org/docs/app/api-reference/config/next-config-js/isolatedDevBuild",
    "https://nextjs.org/docs/app/guides/lazy-loading",
    "https://nextjs.org/docs/app/guides/mcp"
  ]
}