{
  "url": "https://nextjs.org/docs/pages/guides/upgrading/version-9",
  "title": "How to upgrade to version 9",
  "content": "To upgrade to version 9, run the following command:\n\nGood to know: If you are using TypeScript, ensure you also upgrade @types/react and @types/react-dom to their corresponding versions.\n\nIf you previously copied the Custom <App> example, you may be able to remove your getInitialProps.\n\nRemoving getInitialProps from pages/_app.js (when possible) is important to leverage new Next.js features!\n\nThe following getInitialProps does nothing and may be removed:\n\nNext.js will now ignore usage @zeit/next-typescript and warn you to remove it. Please remove this plugin from your next.config.js.\n\nRemove references to @zeit/next-typescript/babel from your custom .babelrc (if present).\n\nThe usage of fork-ts-checker-webpack-plugin should also be removed from your next.config.js.\n\nTypeScript Definitions are published with the next package, so you need to uninstall @types/next as they would conflict.\n\nThe following types are different:\n\nThis list was created by the community to help you upgrade, if you find other differences please send a pull-request to this list to help other users.\n\nYou may no longer export a custom variable named config from a page (i.e. export { config } / export const config ...). This exported variable is now used to specify page-level Next.js configuration like Opt-in AMP and API Route features.\n\nYou must rename a non-Next.js-purposed config export to something different.\n\nDynamic components will not render anything by default while loading. You can still customize this behavior by setting the loading property:\n\nNext.js now has the concept of page-level configuration, so the withAmp higher-order component has been removed for consistency.\n\nThis change can be automatically migrated by running the following commands in the root of your Next.js project:\n\nTo perform this migration by hand, or view what the codemod will produce, see below:\n\nPreviously, exporting pages/about.js would result in out/about/index.html. This behavior has been changed to result in out/about.html.\n\nYou can revert to the previous behavior by creating a next.config.js with the following content:\n\nPages in pages/api/ are now considered API Routes. Pages in this directory will no longer contain a client-side bundle.\n\nThe ability to load multiple modules at once has been deprecated in next/dynamic to be closer to React's implementation (React.lazy and Suspense).\n\nUpdating code that relies on this behavior is relatively straightforward! We've provided an example of a before/after to help you migrate your application:",
  "headings": [
    {
      "level": "h1",
      "text": "How to upgrade to version 9",
      "id": ""
    },
    {
      "level": "h2",
      "text": "Check your Custom App File (pages/_app.js)",
      "id": "check-your-custom-app-file-pages_appjs"
    },
    {
      "level": "h2",
      "text": "Breaking Changes",
      "id": "breaking-changes"
    },
    {
      "level": "h3",
      "text": "@zeit/next-typescript is no longer necessary",
      "id": "zeitnext-typescript-is-no-longer-necessary"
    },
    {
      "level": "h3",
      "text": "The config key is now an export on a page",
      "id": "the-config-key-is-now-an-export-on-a-page"
    },
    {
      "level": "h3",
      "text": "next/dynamic no longer renders \"loading...\" by default while loading",
      "id": "nextdynamic-no-longer-renders-loading-by-default-while-loading"
    },
    {
      "level": "h3",
      "text": "withAmp has been removed in favor of an exported configuration object",
      "id": "withamp-has-been-removed-in-favor-of-an-exported-configuration-object"
    },
    {
      "level": "h3",
      "text": "next export no longer exports pages as index.html",
      "id": "next-export-no-longer-exports-pages-as-indexhtml"
    },
    {
      "level": "h3",
      "text": "pages/api/ is treated differently",
      "id": "pagesapi-is-treated-differently"
    },
    {
      "level": "h2",
      "text": "Deprecated Features",
      "id": "deprecated-features"
    },
    {
      "level": "h3",
      "text": "next/dynamic has deprecated loading multiple modules at once",
      "id": "nextdynamic-has-deprecated-loading-multiple-modules-at-once"
    }
  ],
  "code_samples": [
    {
      "code": "npm i next@9",
      "language": "unknown"
    },
    {
      "code": "yarn add next@9",
      "language": "unknown"
    },
    {
      "code": "pnpm up next@9",
      "language": "unknown"
    },
    {
      "code": "bun add next@9",
      "language": "unknown"
    },
    {
      "code": "class MyApp extends App {\n  // Remove me, I do nothing!\n  static async getInitialProps({ Component, ctx }) {\n    let pageProps = {}\n \n    if (Component.getInitialProps) {\n      pageProps = await Component.getInitialProps(ctx)\n    }\n \n    return { pageProps }\n  }\n \n  render() {\n    // ... etc\n  }\n}",
      "language": "javascript"
    },
    {
      "code": "import { NextContext } from 'next'\nimport { NextAppContext, DefaultAppIProps } from 'next/app'\nimport { NextDocumentContext, DefaultDocumentIProps } from 'next/document'",
      "language": "python"
    },
    {
      "code": "import { NextPageContext } from 'next'\nimport { AppContext, AppInitialProps } from 'next/app'\nimport { DocumentContext, DocumentInitialProps } from 'next/document'",
      "language": "python"
    },
    {
      "code": "import dynamic from 'next/dynamic'\n \nconst DynamicComponentWithCustomLoading = dynamic(\n  () => import('../components/hello2'),\n  {\n    loading: () => <p>Loading</p>,\n  }\n)",
      "language": "python"
    },
    {
      "code": "curl -L https://github.com/vercel/next-codemod/archive/master.tar.gz | tar -xz --strip=2 next-codemod-master/transforms/withamp-to-config.js npx jscodeshift -t ./withamp-to-config.js pages/**/*.js",
      "language": "unknown"
    },
    {
      "code": "import { withAmp } from 'next/amp'\n \nfunction Home() {\n  return <h1>My AMP Page</h1>\n}\n \nexport default withAmp(Home)\n// or\nexport default withAmp(Home, { hybrid: true })",
      "language": "python"
    },
    {
      "code": "export default function Home() {\n  return <h1>My AMP Page</h1>\n}\n \nexport const config = {\n  amp: true,\n  // or\n  amp: 'hybrid',\n}",
      "language": "javascript"
    },
    {
      "code": "module.exports = {\n  trailingSlash: true,\n}",
      "language": "unknown"
    },
    {
      "code": "import dynamic from 'next/dynamic'\n \nconst HelloBundle = dynamic({\n  modules: () => {\n    const components = {\n      Hello1: () => import('../components/hello1').then((m) => m.default),\n      Hello2: () => import('../components/hello2').then((m) => m.default),\n    }\n \n    return components\n  },\n  render: (props, { Hello1, Hello2 }) => (\n    <div>\n      <h1>{props.title}</h1>\n      <Hello1 />\n      <Hello2 />\n    </div>\n  ),\n})\n \nfunction DynamicBundle() {\n  return <HelloBundle title=\"Dynamic Bundle\" />\n}\n \nexport default DynamicBundle",
      "language": "python"
    },
    {
      "code": "import dynamic from 'next/dynamic'\n \nconst Hello1 = dynamic(() => import('../components/hello1'))\nconst Hello2 = dynamic(() => import('../components/hello2'))\n \nfunction HelloBundle({ title }) {\n  return (\n    <div>\n      <h1>{title}</h1>\n      <Hello1 />\n      <Hello2 />\n    </div>\n  )\n}\n \nfunction DynamicBundle() {\n  return <HelloBundle title=\"Dynamic Bundle\" />\n}\n \nexport default DynamicBundle",
      "language": "python"
    }
  ],
  "patterns": [],
  "links": [
    "https://nextjs.org/docs/pages/guides",
    "https://nextjs.org/docs/pages/guides/upgrading",
    "https://nextjs.org/docs/pages/guides/upgrading/version-9",
    "https://nextjs.org/docs/pages/building-your-application/routing/custom-app",
    "https://nextjs.org/docs/pages/guides/upgrading/version-14",
    "https://nextjs.org/docs/pages/building-your-application"
  ]
}