{
  "url": "https://nextjs.org/docs/app/guides/prefetching",
  "title": "Prefetching",
  "content": "Prefetching makes navigating between different routes in your application feel instant. Next.js tries to intelligently prefetch by default, based on the links used in your application code.\n\nThis guide will explain how prefetching works and show common implementation patterns:\n\nWhen navigating between routes, the browser requests assets for the page like HTML and JavaScript files. Prefetching is the process of fetching these resources ahead of time, before you navigate to a new route.\n\nNext.js automatically splits your application into smaller JavaScript chunks based on routes. Instead of loading all the code upfront like traditional SPAs, only the code needed for the current route is loaded. This reduces the initial load time while other parts of the app are loaded in the background. By the time you click the link, the resources for the new route have already been loaded into the browser cache.\n\nWhen navigating to the new page, there's no full page reload or browser loading spinner. Instead, Next.js performs a client-side transition, making the page navigation feel instant.\n\nGood to know: During the initial navigation, the browser fetches the HTML, JavaScript, and React Server Components (RSC) Payload. For subsequent navigations, the browser will fetch the RSC Payload for Server Components and JS bundle for Client Components.\n\nAutomatic prefetching runs only in production. Disable with prefetch={false} or use the wrapper in Disabled Prefetch.\n\nTo do manual prefetching, import the useRouter hook from next/navigation, and call router.prefetch() to warm routes outside the viewport or in response to analytics, hover, scroll, etc.\n\nIf the intent is to prefetch a URL when a component loads, see the extending or rejecting a link [example].\n\nProceed with caution: Extending Link opts you into maintaining prefetching, cache invalidation, and accessibility concerns. Proceed only if defaults are insufficient.\n\nNext.js tries to do the right prefetching by default, but power users can eject and modify based on their needs. You have the control between performance and resource consumption.\n\nFor example, you might have to only trigger prefetches on hover, instead of when entering the viewport (the default behavior):\n\nprefetch={null} restores default (static) prefetching once the user shows intent.\n\nYou can extend the <Link> component to create your own custom prefetching strategy. For example, using the ForesightJS library which prefetches links by predicting the direction of the user's cursor.\n\nAlternatively, you can use useRouter to recreate some of the native <Link> behavior. However, be aware this opts you into maintaining prefetching and cache invalidation.\n\nonInvalidate is invoked when Next.js suspects cached data is stale, allowing you to refresh the prefetch.\n\nGood to know: Using an a tag will cause a full page navigation to the destination route, you can use onClick to prevent the full page navigation, and then invoke router.push to navigate to the destination.\n\nYou can fully disable prefetching for certain routes for more fine-grained control over resource consumption.\n\nFor example, you may still want to have consistent usage of <Link> in your application, but links in your footer might not need to be prefetched when entering the viewport.\n\nNext.js stores prefetched React Server Component payloads in memory, keyed by route segments. When navigating between sibling routes (e.g. /dashboard/settings â†’ /dashboard/analytics), it reuses the parent layout and only fetches the updated leaf page. This reduces network traffic and improves navigation speed.\n\nNext.js maintains a small task queue, which prefetches in the following order:\n\nThe scheduler prioritizes likely navigations while minimizing unused downloads.\n\nWhen PPR is enabled, a page is divided into a static shell and a streamed dynamic section:\n\nIf your layouts or pages are not pure and have side-effects (e.g. tracking analytics), these might be triggered when the route is prefetched, not when the user visits the page.\n\nTo avoid this, you should move side-effects to a useEffect hook or a Server Action triggered from a Client Component.\n\nNext.js automatically prefetches links in the viewport when using the <Link> component.\n\nThere may be cases where you want to prevent this to avoid unnecessary usage of resources, such as when rendering a large list of links (e.g. an infinite scroll table).\n\nYou can disable prefetching by setting the prefetch prop of the <Link> component to false.\n\nHowever, this means static routes will only be fetched on click, and dynamic routes will wait for the server to render before navigating.\n\nTo reduce resource usage without disabling prefetch entirely, you can defer prefetching until the user hovers over a link. This targets only links the user is likely to visit.",
  "headings": [
    {
      "level": "h1",
      "text": "Prefetching",
      "id": ""
    },
    {
      "level": "h2",
      "text": "How does prefetching work?",
      "id": "how-does-prefetching-work"
    },
    {
      "level": "h2",
      "text": "Prefetching static vs. dynamic routes",
      "id": "prefetching-static-vs-dynamic-routes"
    },
    {
      "level": "h2",
      "text": "Automatic prefetch",
      "id": "automatic-prefetch"
    },
    {
      "level": "h2",
      "text": "Manual prefetch",
      "id": "manual-prefetch"
    },
    {
      "level": "h2",
      "text": "Hover-triggered prefetch",
      "id": "hover-triggered-prefetch"
    },
    {
      "level": "h2",
      "text": "Extending or ejecting link",
      "id": "extending-or-ejecting-link"
    },
    {
      "level": "h2",
      "text": "Disabled prefetch",
      "id": "disabled-prefetch"
    },
    {
      "level": "h2",
      "text": "Prefetching optimizations",
      "id": "prefetching-optimizations"
    },
    {
      "level": "h3",
      "text": "Client cache",
      "id": "client-cache"
    },
    {
      "level": "h3",
      "text": "Prefetch scheduling",
      "id": "prefetch-scheduling"
    },
    {
      "level": "h3",
      "text": "Partial Prerendering (PPR)",
      "id": "partial-prerendering-ppr"
    },
    {
      "level": "h2",
      "text": "Troubleshooting",
      "id": "troubleshooting"
    },
    {
      "level": "h3",
      "text": "Triggering unwanted side-effects during prefetching",
      "id": "triggering-unwanted-side-effects-during-prefetching"
    },
    {
      "level": "h3",
      "text": "Preventing too many prefetches",
      "id": "preventing-too-many-prefetches"
    }
  ],
  "code_samples": [
    {
      "code": "import Link from 'next/link'\n \nexport default function NavLink() {\n  return <Link href=\"/about\">About</Link>\n}",
      "language": "python"
    },
    {
      "code": "'use client'\n \nimport { useRouter } from 'next/navigation'\nimport { CustomLink } from '@components/link'\n \nexport function PricingCard() {\n  const router = useRouter()\n \n  return (\n    <div onMouseEnter={() => router.prefetch('/pricing')}>\n      {/* other UI elements */}\n      <CustomLink href=\"/pricing\">View Pricing</CustomLink>\n    </div>\n  )\n}",
      "language": "python"
    },
    {
      "code": "'use client'\n \nimport Link from 'next/link'\nimport { useState } from 'react'\n \nexport function HoverPrefetchLink({\n  href,\n  children,\n}: {\n  href: string\n  children: React.ReactNode\n}) {\n  const [active, setActive] = useState(false)\n \n  return (\n    <Link\n      href={href}\n      prefetch={active ? null : false}\n      onMouseEnter={() => setActive(true)}\n    >\n      {children}\n    </Link>\n  )\n}",
      "language": "python"
    },
    {
      "code": "'use client'\n \nimport { useRouter } from 'next/navigation'\nimport { useEffect } from 'react'\n \nfunction ManualPrefetchLink({\n  href,\n  children,\n}: {\n  href: string\n  children: React.ReactNode\n}) {\n  const router = useRouter()\n \n  useEffect(() => {\n    let cancelled = false\n    const poll = () => {\n      if (!cancelled) router.prefetch(href, { onInvalidate: poll })\n    }\n    poll()\n    return () => {\n      cancelled = true\n    }\n  }, [href, router])\n \n  return (\n    <a\n      href={href}\n      onClick={(event) => {\n        event.preventDefault()\n        router.push(href)\n      }}\n    >\n      {children}\n    </a>\n  )\n}",
      "language": "python"
    },
    {
      "code": "'use client'\n \nimport Link, { LinkProps } from 'next/link'\n \nfunction NoPrefetchLink({\n  prefetch,\n  ...rest\n}: LinkProps & { children: React.ReactNode }) {\n  return <Link {...rest} prefetch={false} />\n}",
      "language": "python"
    },
    {
      "code": "import { trackPageView } from '@/lib/analytics'\n \nexport default function Layout({ children }: { children: React.ReactNode }) {\n  // This runs during prefetch\n  trackPageView()\n \n  return <div>{children}</div>\n}",
      "language": "python"
    },
    {
      "code": "'use client'\n \nimport { useEffect } from 'react'\nimport { trackPageView } from '@/lib/analytics'\n \nexport function AnalyticsTracker() {\n  useEffect(() => {\n    trackPageView()\n  }, [])\n \n  return null\n}",
      "language": "python"
    },
    {
      "code": "import { AnalyticsTracker } from '@/app/ui/analytics-tracker'\n \nexport default function Layout({ children }: { children: React.ReactNode }) {\n  return (\n    <div>\n      <AnalyticsTracker />\n      {children}\n    </div>\n  )\n}",
      "language": "python"
    },
    {
      "code": "<Link prefetch={false} href={`/blog/${post.id}`}>\n  {post.title}\n</Link>",
      "language": "unknown"
    },
    {
      "code": "'use client'\n \nimport Link from 'next/link'\nimport { useState } from 'react'\n \nexport function HoverPrefetchLink({\n  href,\n  children,\n}: {\n  href: string\n  children: React.ReactNode\n}) {\n  const [active, setActive] = useState(false)\n \n  return (\n    <Link\n      href={href}\n      prefetch={active ? null : false}\n      onMouseEnter={() => setActive(true)}\n    >\n      {children}\n    </Link>\n  )\n}",
      "language": "python"
    }
  ],
  "patterns": [],
  "links": [
    "https://nextjs.org/docs/app",
    "https://nextjs.org/docs/app/guides",
    "https://nextjs.org/docs/app/guides/prefetching",
    "https://nextjs.org/docs/app/getting-started/linking-and-navigating",
    "https://nextjs.org/docs/app/api-reference/file-conventions/loading",
    "https://nextjs.org/docs/app/guides/caching",
    "https://nextjs.org/docs/app/api-reference/config/next-config-js/staleTimes",
    "https://nextjs.org/docs/app/getting-started/cache-components",
    "https://nextjs.org/docs/app/api-reference/functions/use-router",
    "https://nextjs.org/docs/app/guides/package-bundling",
    "https://nextjs.org/docs/app/guides/production-checklist"
  ]
}