{
  "title": "Microsoft credentials",
  "content": "You can use these credentials to authenticate the following nodes:\n\n- [Microsoft Dynamics CRM](../../app-nodes/n8n-nodes-base.microsoftdynamicscrm/)\n- [Microsoft Excel](../../app-nodes/n8n-nodes-base.microsoftexcel/)\n- [Microsoft Graph Security](../../app-nodes/n8n-nodes-base.microsoftgraphsecurity/)\n- [Microsoft OneDrive](../../app-nodes/n8n-nodes-base.microsoftonedrive/)\n- [Microsoft Outlook](../../app-nodes/n8n-nodes-base.microsoftoutlook/)\n- [Microsoft SharePoint](../../app-nodes/n8n-nodes-base.microsoftsharepoint/)\n- [Microsoft Teams](../../app-nodes/n8n-nodes-base.microsoftteams/)\n- [Microsoft Teams Trigger](../../trigger-nodes/n8n-nodes-base.microsoftteamstrigger/)\n- [Microsoft To Do](../../app-nodes/n8n-nodes-base.microsofttodo/)\n\n- Create a [Microsoft Azure](https://azure.microsoft.com/) account.\n- Create at least one user account with access to the appropriate service.\n- If a corporate Microsoft Entra account manages the user account, the administrator account has enabled the option “User can consent to apps accessing company data on their behalf” for this user (see the [Microsoft Entra documentation](https://learn.microsoft.com/en-us/entra/identity/enterprise-apps/grant-admin-consent)).\n\n## Supported authentication methods\n\nRefer to the linked Microsoft API documentation below for more information about each service's API:\n\n- Dynamics CRM: [Web API](https://learn.microsoft.com/en-us/power-apps/developer/data-platform/webapi/overview)\n- Excel: [Graph API](https://learn.microsoft.com/en-us/graph/api/resources/excel)\n- Graph Security: [Graph API](https://learn.microsoft.com/en-us/graph/api/overview)\n- OneDrive: [Graph API](https://learn.microsoft.com/en-us/onedrive/developer/rest-api/)\n- Outlook: [Graph API](https://learn.microsoft.com/en-us/graph/api/resources/mail-api-overview) and [Outlook API](https://learn.microsoft.com/en-us/outlook/rest/reference)\n- Teams: [Graph API](https://learn.microsoft.com/en-us/graph/api/resources/teams-api-overview)\n- To Do: [Graph API](https://learn.microsoft.com/en-us/graph/todo-concept-overview)\n\nNote for n8n Cloud users\n\nCloud users don't need to provide connection details. Select **Connect my account** to connect through your browser.\n\nSome Microsoft services require extra information for OAuth2. Refer to [Service-specific settings](#service-specific-settings) for more guidance on those services.\n\nFor self-hosted users, there are two main steps to configure OAuth2 from scratch:\n\n1. [Register an application](#register-an-application) with the Microsoft Identity Platform.\n1. [Generate a client secret](#generate-a-client-secret) for that application.\n\nFollow the detailed instructions for each step below. For more detail on the Microsoft OAuth2 web flow, refer to [Microsoft authentication and authorization basics](https://learn.microsoft.com/en-us/graph/auth/auth-concepts).\n\n### Register an application\n\nRegister an application with the Microsoft Identity Platform:\n\n1. Open the [Microsoft Application Registration Portal](https://aka.ms/appregistrations).\n1. Select **Register an application**.\n1. Enter a **Name** for your app.\n1. In **Supported account types**, select **Accounts in any organizational directory (Any Azure AD directory - Multi-tenant) and personal Microsoft accounts (for example, Skype, Xbox)**.\n1. In **Register an application**:\n   1. Copy the **OAuth Callback URL** from your n8n credential.\n   1. Paste it into the **Redirect URI (optional)** field.\n   1. Select **Select a platform** > **Web**.\n1. Select **Register** to finish creating your application.\n1. Copy the **Application (client) ID** and paste it into n8n as the **Client ID**.\n\nRefer to [Register an application with the Microsoft Identity Platform](https://learn.microsoft.com/en-us/graph/auth-register-app-v2) for more information.\n\n### Generate a client secret\n\nWith your application created, generate a client secret for it:\n\n1. On your Microsoft application page, select **Certificates & secrets** in the left navigation.\n1. In **Client secrets**, select **+ New client secret**.\n1. Enter a **Description** for your client secret, such as `n8n credential`.\n1. Select **Add**.\n1. Copy the **Secret** in the **Value** column.\n1. Paste it into n8n as the **Client Secret**.\n1. If you see other fields in the n8n credential, refer to [Service-specific settings](#service-specific-settings) below for guidance on completing those fields.\n1. Select **Connect my account** in n8n to finish setting up the connection.\n1. Log in to your Microsoft account and allow the app to access your info.\n\nRefer to Microsoft's [Add credentials](https://learn.microsoft.com/en-us/graph/auth-register-app-v2#add-credentials) for more information on adding a client secret.\n\n### Service-specific settings\n\nThe following services require extra information for OAuth2:\n\nDynamics OAuth2 requires information about your Dynamics domain and region. Follow these extra steps to complete the credential:\n\n1. Enter your Dynamics **Domain**.\n1. Select the Dynamics data center **Region** you're within.\n\nRefer to the [Microsoft Datacenter regions documentation](https://learn.microsoft.com/en-us/power-platform/admin/new-datacenter-regions) for more information on the region options and corresponding URLs.\n\n#### Microsoft (general)\n\nThe general Microsoft OAuth2 also requires you to provide a space-separated list of **Scope**s for this credential.\n\nRefer to [Scopes and permissions in the Microsoft identity platform](https://learn.microsoft.com/en-us/entra/identity-platform/scopes-oidc) for a list of possible scopes.\n\nOutlook OAuth2 supports the credential accessing a user's primary email inbox or a shared inbox. By default, the credential will access a user's primary email inbox. To change this behavior:\n\n1. Turn on **Use Shared Inbox**.\n1. Enter the target user's UPN or ID as the **User Principal Name**.\n\nSharePoint OAuth2 requires information about your SharePoint **Subdomain**.\n\nTo complete the credential, enter the **Subdomain** part of your SharePoint URL. For example, if your SharePoint URL is `https://tenant123.sharepoint.com`, the subdomain is `tenant123`.\n\nSharePoint requires the following permissions:\n\nApplication permissions:\n\n- `Sites.Read.All`\n- `Sites.ReadWrite.All`\n\nDelegated permissions:\n\n- `SearchConfiguration.Read.All`\n- `SearchConfiguration.ReadWrite.All`\n\nHere are the known common errors and issues with Microsoft OAuth2 credentials.\n\n### Need admin approval\n\nWhen attempting to add credentials for a Microsoft360 or Microsoft Entra account, users may see a message when following the procedure that this action requires admin approval.\n\nThis message will appear when the account attempting to grant permissions for the credential is managed by a Microsoft Entra. In order to issue the credential, the administrator account needs to grant permission to the user (or \"tenant\") for that application.\n\nThe procedure for this is covered in the [Microsoft Entra documentation](https://learn.microsoft.com/en-us/entra/identity/enterprise-apps/grant-admin-consent).",
  "code_samples": [],
  "headings": [
    {
      "level": "h2",
      "text": "Prerequisites",
      "id": "prerequisites"
    },
    {
      "level": "h2",
      "text": "Supported authentication methods",
      "id": "supported-authentication-methods"
    },
    {
      "level": "h2",
      "text": "Related resources",
      "id": "related-resources"
    },
    {
      "level": "h2",
      "text": "Using OAuth2",
      "id": "using-oauth2"
    },
    {
      "level": "h3",
      "text": "Register an application",
      "id": "register-an-application"
    },
    {
      "level": "h3",
      "text": "Generate a client secret",
      "id": "generate-a-client-secret"
    },
    {
      "level": "h3",
      "text": "Service-specific settings",
      "id": "service-specific-settings"
    },
    {
      "level": "h2",
      "text": "Common issues",
      "id": "common-issues"
    },
    {
      "level": "h3",
      "text": "Need admin approval",
      "id": "need-admin-approval"
    }
  ],
  "url": "llms-txt#microsoft-credentials",
  "links": []
}