{
  "title": "Query JSON with JMESPath",
  "content": "[JMESPath](https://jmespath.org/) is a query language for JSON that you can use to extract and transform elements from a JSON document. For full details of how to use JMESPath, refer to the [JMESPath documentation](https://jmespath.org/tutorial.html).\n\n## The `jmespath()` method\n\nn8n provides a custom method, `jmespath()`. Use this method to perform a search on a JSON object using the JMESPath query language.\n\nTo help understand what the method does, here is the equivalent longer JavaScript:\n\nExpressions must be single-line\n\nThe longer code example doesn't work in Expressions, as they must be single-line.\n\n`object` is a JSON object, such as the output of a previous node. `searchString` is an expression written in the JMESPath query language. The [JMESPath Specification](https://jmespath.org/specification.html#jmespath-specification) provides a list of supported expressions, while their [Tutorial](https://jmespath.org/tutorial.html) and [Examples](https://jmespath.org/examples.html) provide interactive examples.\n\nSearch parameter order\n\nThe examples in the [JMESPath Specification](https://jmespath.org/specification.html#jmespath-specification) follow the pattern `search(searchString, object)`. The [JMESPath JavaScript library](https://github.com/jmespath/jmespath.js/), which n8n uses, supports `search(object, searchString)` instead. This means that when using examples from the JMESPath documentation, you may need to change the order of the search function parameters.\n\nThis section provides examples for some common operations. More examples, and detailed guidance, are available in [JMESPath's own documentation](https://jmespath.org/tutorial.html).\n\nWhen trying out these examples, you need to set the Code node **Mode** to **Run Once for Each Item**.\n\n### Apply a JMESPath expression to a collection of elements with projections\n\nFrom the [JMESPath projections documentation](https://jmespath.org/tutorial.html#projections):\n\n> Projections are one of the key features of JMESPath. Use it to apply an expression to a collection of elements. JMESPath supports five kinds of projections:\n>\n> - List Projections\n> - Slice Projections\n> - Object Projections\n> - Flatten Projections\n> - Filter Projections\n\nThe following example shows basic usage of list, slice, and object projections. Refer to the [JMESPath projections documentation](https://jmespath.org/tutorial.html#projections) for detailed explanations of each projection type, and more examples.\n\nGiven this JSON from a webhook node:\n\nRetrieve a [list](https://jmespath.org/tutorial.html#list-and-slice-projections) of all the people's first names:\n\nGet a [slice](https://jmespath.org/tutorial.html#list-and-slice-projections) of the first names:\n\nGet a list of the dogs' ages using [object projections](https://jmespath.org/tutorial.html#object-projections):\n\n### Select multiple elements and create a new list or object\n\nUse [Multiselect](https://jmespath.org/tutorial.html#multiselect) to select elements from a JSON object and combine them into a new list or object.\n\nGiven this JSON from a webhook node:\n\nUse multiselect list to get the first and last names and create new lists containing both names:\n\n### An alternative to arrow functions in expressions\n\nFor example, generate some input data by returning the below code from the Code node:\n\nYou could do a search like \"find the item with the name Lenovo and tell me their category ID.\"",
  "code_samples": [
    {
      "code": "$jmespath(object, searchString)",
      "language": "unknown"
    },
    {
      "code": "_jmespath(object, searchString)",
      "language": "unknown"
    },
    {
      "code": "var jmespath = require('jmespath');\njmespath.search(object, searchString);",
      "language": "unknown"
    },
    {
      "code": "[\n  {\n    \"headers\": {\n      \"host\": \"n8n.instance.address\",\n      ...\n    },\n    \"params\": {},\n    \"query\": {},\n    \"body\": {\n      \"people\": [\n        {\n          \"first\": \"James\",\n          \"last\": \"Green\"\n        },\n        {\n          \"first\": \"Jacob\",\n          \"last\": \"Jones\"\n        },\n        {\n          \"first\": \"Jayden\",\n          \"last\": \"Smith\"\n        }\n      ],\n      \"dogs\": {\n        \"Fido\": {\n          \"color\": \"brown\",\n          \"age\": 7\n        },\n        \"Spot\": {\n          \"color\": \"black and white\",\n          \"age\": 5\n        }\n      }\n    }\n  }\n]",
      "language": "unknown"
    },
    {
      "code": "{{$jmespath($json.body.people, \"[*].first\" )}}\n// Returns [\"James\", \"Jacob\", \"Jayden\"]",
      "language": "unknown"
    },
    {
      "code": "let firstNames = $jmespath($json.body.people, \"[*].first\" )\nreturn {firstNames};\n/* Returns:\n[\n\t{\n\t\t\"firstNames\": [\n\t\t\t\"James\",\n\t\t\t\"Jacob\",\n\t\t\t\"Jayden\"\n\t\t]\n\t}\n]\n*/",
      "language": "unknown"
    },
    {
      "code": "firstNames = _jmespath(_json.body.people, \"[*].first\" )\nreturn {\"firstNames\":firstNames}\n\"\"\"\nReturns:\n[\n \t{\n\t\t\"firstNames\": [\n\t\t\t\"James\",\n\t\t\t\"Jacob\",\n\t\t\t\"Jayden\"\n\t\t]\n\t}\n]\n\"\"\"",
      "language": "unknown"
    },
    {
      "code": "{{$jmespath($json.body.people, \"[:2].first\")}}\n// Returns [\"James\", \"Jacob\"]",
      "language": "unknown"
    },
    {
      "code": "let firstTwoNames = $jmespath($json.body.people, \"[:2].first\");\nreturn {firstTwoNames};\n/* Returns:\n[\n\t{\n\t\t\"firstNames\": [\n\t\t\t\"James\",\n\t\t\t\"Jacob\",\n\t\t\t\"Jayden\"\n\t\t]\n\t}\n]\n*/",
      "language": "unknown"
    },
    {
      "code": "firstTwoNames = _jmespath(_json.body.people, \"[:2].first\" )\nreturn {\"firstTwoNames\":firstTwoNames}\n\"\"\"\nReturns:\n[\n\t{\n\t\t\"firstTwoNames\": [\n\t\t\"James\",\n\t\t\"Jacob\"\n\t\t]\n\t}\n]\n\"\"\"",
      "language": "unknown"
    },
    {
      "code": "{{$jmespath($json.body.dogs, \"*.age\")}}\n// Returns [7,5]",
      "language": "unknown"
    },
    {
      "code": "let dogsAges = $jmespath($json.body.dogs, \"*.age\");\nreturn {dogsAges};\n/* Returns:\n[\n\t{\n\t\t\"dogsAges\": [\n\t\t\t7,\n\t\t\t5\n\t\t]\n\t}\n]\n*/",
      "language": "unknown"
    },
    {
      "code": "dogsAges = _jmespath(_json.body.dogs, \"*.age\")\nreturn {\"dogsAges\": dogsAges}\n\"\"\"\nReturns:\n[\n\t{\n\t\t\"dogsAges\": [\n\t\t\t7,\n\t\t\t5\n\t\t]\n\t}\n]\n\"\"\"",
      "language": "unknown"
    },
    {
      "code": "[\n  {\n    \"headers\": {\n      \"host\": \"n8n.instance.address\",\n      ...\n    },\n    \"params\": {},\n    \"query\": {},\n    \"body\": {\n      \"people\": [\n        {\n          \"first\": \"James\",\n          \"last\": \"Green\"\n        },\n        {\n          \"first\": \"Jacob\",\n          \"last\": \"Jones\"\n        },\n        {\n          \"first\": \"Jayden\",\n          \"last\": \"Smith\"\n        }\n      ],\n      \"dogs\": {\n        \"Fido\": {\n          \"color\": \"brown\",\n          \"age\": 7\n        },\n        \"Spot\": {\n          \"color\": \"black and white\",\n          \"age\": 5\n        }\n      }\n    }\n  }\n]",
      "language": "unknown"
    },
    {
      "code": "{{$jmespath($json.body.people, \"[].[first, last]\")}}\n// Returns [[\"James\",\"Green\"],[\"Jacob\",\"Jones\"],[\"Jayden\",\"Smith\"]]",
      "language": "unknown"
    },
    {
      "code": "let newList = $jmespath($json.body.people, \"[].[first, last]\");\nreturn {newList};\n/* Returns:\n[\n\t{\n\t\t\"newList\": [\n\t\t\t[\n\t\t\t\t\"James\",\n\t\t\t\t\"Green\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Jacob\",\n\t\t\t\t\"Jones\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Jayden\",\n\t\t\t\t\"Smith\"\n\t\t\t]\n\t\t]\n\t}\n]\n*/",
      "language": "unknown"
    },
    {
      "code": "newList = _jmespath(_json.body.people, \"[].[first, last]\")\nreturn {\"newList\":newList}\n\"\"\"\nReturns:\n[\n\t{\n\t\t\"newList\": [\n\t\t\t[\n\t\t\t\t\"James\",\n\t\t\t\t\"Green\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Jacob\",\n\t\t\t\t\"Jones\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Jayden\",\n\t\t\t\t\"Smith\"\n\t\t\t]\n\t\t]\n\t}\n]\n\"\"\"",
      "language": "unknown"
    },
    {
      "code": "return[\n  {\n    \"json\": {      \n      \"num_categories\": \"0\",\n      \"num_products\": \"45\",\n      \"category_id\": 5529735,\n      \"parent_id\": 1407340,\n      \"pos_enabled\": 1,\n      \"pos_favorite\": 0,\n      \"name\": \"HP\",\n      \"description\": \"\",\n      \"image\": \"\"\n    }\n  },\n  {\n    \"json\": {\n      \"num_categories\": \"0\",\n      \"num_products\": \"86\",\n      \"category_id\": 5529740,\n      \"parent_id\": 1407340,\n      \"pos_enabled\": 1,\n      \"pos_favorite\": 0,\n      \"name\": \"Lenovo\",\n      \"description\": \"\",\n      \"image\": \"\"\n    }\n  }  \n]",
      "language": "unknown"
    },
    {
      "code": "{{ $jmespath($(\"Code\").all(), \"[?json.name=='Lenovo'].json.category_id\") }}",
      "language": "unknown"
    }
  ],
  "headings": [
    {
      "level": "h2",
      "text": "The `jmespath()` method",
      "id": "the-`jmespath()`-method"
    },
    {
      "level": "h2",
      "text": "Common tasks",
      "id": "common-tasks"
    },
    {
      "level": "h3",
      "text": "Apply a JMESPath expression to a collection of elements with projections",
      "id": "apply-a-jmespath-expression-to-a-collection-of-elements-with-projections"
    },
    {
      "level": "h3",
      "text": "Select multiple elements and create a new list or object",
      "id": "select-multiple-elements-and-create-a-new-list-or-object"
    },
    {
      "level": "h3",
      "text": "An alternative to arrow functions in expressions",
      "id": "an-alternative-to-arrow-functions-in-expressions"
    }
  ],
  "url": "llms-txt#query-json-with-jmespath",
  "links": []
}