{
  "title": "External secrets",
  "content": "- External secrets are available on Enterprise Self-hosted and Enterprise Cloud plans.\n- n8n supports AWS Secrets Manager, Azure Key Vault, GCP Secrets Manager, Infisical and HashiCorp Vault.\n- n8n doesn't support [HashiCorp Vault Secrets](https://developer.hashicorp.com/hcp/docs/vault-secrets).\n\nYou can use an external secrets store to manage [credentials](../glossary/#credential-n8n) for n8n.\n\nn8n stores all credentials encrypted in its database, and restricts access to them by default. With the external secrets feature, you can store sensitive credential information in an external vault, and have n8n load it in when required. This provides an extra layer of security and allows you to manage credentials used across multiple [n8n environments](../source-control-environments/) in one central place.\n\n## Connect n8n to your secrets store\n\nYour secret names can't contain spaces, hyphens, or other special characters. n8n supports secret names containing alphanumeric characters (`a-z`, `A-Z`, and `0-9`), and underscores. n8n currently only supports plaintext values for secrets, not JSON objects or key-value pairs.\n\n1. In n8n, go to **Settings** > **External Secrets**.\n\n1. Select **Set Up** for your store provider.\n\n1. Enter the credentials for your provider:\n\n- Azure Key Vault: Provide your **vault name**, **tenant ID**, **client ID**, and **client secret**. Refer to the Azure documentation to [register a Microsoft Entra ID app and create a service principal](https://learn.microsoft.com/en-us/entra/identity-platform/howto-create-service-principal-portal). n8n supports only single-line values for secrets.\n\n- AWS Secrets Manager: provide your **access key ID**, **secret access key**, and **region**. The IAM user must have the `secretsmanager:ListSecrets`, `secretsmanager:BatchGetSecretValue`, and `secretsmanager:GetSecretValue` permissions.\n\nTo give n8n access to all secrets in your AWS Secrets Manager, you can attach the following policy to the IAM user:\n\nYou can also be more restrictive and give n8n access to select specific AWS Secret Manager secrets. You still need to allow the `secretsmanager:ListSecrets` and `secretsmanager:BatchGetSecretValue` permissions to access all resources. These permissions allow n8n to retrieve ARN-scoped secrets, but don't provide access to the secret values.\n\nNext, you need set the scope for the `secretsmanager:GetSecretValue` permission to the specific Amazon Resource Names (ARNs) for the secrets you wish to share with n8n. Ensure you use the correct region and account ID in each resource ARNs. You can find the ARN details in the AWS dashboard for your secrets.\n\nFor example, the following IAM policy only allows access to secrets with a name starting with `n8n` in your specified AWS account and region:\n\nFor more IAM permission policy examples, consult the [AWS documentation](https://docs.aws.amazon.com/secretsmanager/latest/userguide/auth-and-access_iam-policies.html#auth-and-access_examples_batch).\n\n- HashiCorp Vault: provide the **Vault URL** for your vault instance, and select your **Authentication Method**. Enter your authentication details. Optionally provide a namespace.\n\n- Refer to the HashiCorp documentation for your authentication method: [Token auth method](https://developer.hashicorp.com/vault/docs/auth/token)\\\n       [AppRole auth method](https://developer.hashicorp.com/vault/docs/auth/approle)\\\n       [Userpass auth method](https://developer.hashicorp.com/vault/docs/auth/userpass)\n     - If you use vault namespaces, you can enter the namespace n8n should connect to. Refer to [Vault Enterprise namespaces](https://developer.hashicorp.com/vault/docs/enterprise/namespaces) for more information on HashiCorp Vault namespaces.\n\n- Infisical: provide a **Service Token**. Refer to Infisical's [Service token](https://infisical.com/docs/documentation/platform/token) documentation for information on getting your token. If you self-host Infisical, enter the **Site URL**.\n\nInfisical environment\n\nMake sure you select the correct Infisical environment when creating your token. n8n will load secrets from this environment, and won't have access to secrets in other Infisical environments. n8n only support service tokens that have access to a single environment.\n\nn8n doesn't support [Infisical folders](https://infisical.com/docs/documentation/platform/folder).\n\n- Google Cloud Platform: provide a **Service Account Key** (JSON) for a service account that has at least these roles: `Secret Manager Secret Accessor` and `Secret Manager Secret Viewer`. Refer to Google's [service account documentation](https://cloud.google.com/iam/docs/service-account-overview) for more information.\n\n1. **Save** your configuration.\n\n1. Enable the provider using the **Disabled / Enabled** toggle.\n\n## Use secrets in n8n credentials\n\nTo use a secret from your store in an n8n credential:\n\n1. Create a new credential, or open an existing one.\n\n1. On the field where you want to use a secret:\n\n1. Hover over the field.\n   1. Select **Expression**.\n\n1. In the field where you want to use a secret, enter an [expression](../glossary/#expression-n8n) referencing the secret name:\n\n`<vault-name>` is either `vault` (for HashiCorp) or `infisical` or `awsSecretsManager`. Replace `<secret-name>` with the name as it appears in your vault.\n\n## Using external secrets with n8n environments\n\nn8n's [Source control and environments](../source-control-environments/) feature allows you to create different n8n environments, backed by Git. The feature doesn't support using different credentials in different instances. You can use an external secrets vault to provide different credentials for different environments by connecting each n8n instance to a different vault or project environment.\n\nFor example, you have two n8n instances, one for development and one for production. You use Infisical for your vault. In Infisical, create a project with two environments, development and production. Generate a token for each Infisical environment. Use the token for the development environment to connect your development n8n instance, and the token for your production environment to connect your production n8n instance.\n\n## Using external secrets in projects\n\nTo use external secrets in an [RBAC project](../user-management/rbac/), you must have an [instance owner or instance admin](../user-management/account-types/) as a member of the project.\n\n### Infisical version changes\n\nInfisical version upgrades can introduce problems connecting to n8n. If your Infisical connection stops working, check if there was a recent version change. If so, report the issue to help@n8n.io.\n\n### Only set external secrets on credentials owned by an instance owner or admin\n\nDue to the permissions that instance owners and admins have, it's possible for owners and admins to update credentials owned by another user with a secrets expression. This will appear to work in preview for an instance owner or admin, but the secret won't resolve when the workflow runs in production.\n\nOnly use external secrets for credentials that are owned by an instance admin or owner. This ensures they resolve correctly in production.\n\nAI agents are artificial intelligence systems capable of responding to requests, making decisions, and performing real-world tasks for users. They use large language models (LLMs) to interpret user input and make decisions about how to best process requests using the information and resources they have available.\n\nAI chains allow you to interact with large language models (LLMs) and other resources in sequences of calls to components. AI chains in n8n don't use persistent memory, so you can't use them to reference previous context (use AI agents for this).\n\nCompletions are the responses generated by a model like GPT.\n\nEmbeddings are numerical representations of data using vectors. They're used by AI to interpret complex data and relationships by mapping values across many dimensions. Vector databases, or vector stores, are databases designed to store and access embeddings.\n\nIn AI, and specifically in retrieval-augmented generation (RAG) contexts, groundedness and ungroundedness are measures of how much a model's responses accurately reflect source information. The model uses its source documents to generate grounded responses, while ungrounded responses involve speculation or hallucination unsupported by those same sources.\n\n#### AI hallucination\n\nHallucination in AI is when an LLM (large language model) mistakenly perceives patterns or objects that don't exist.\n\nReranking is a technique that refines the order of a list of candidate documents to improve the relevance of search results. Retrieval-Augmented Generation (RAG) and other applications use reranking to prioritize the most relevant information for generation or downstream tasks.\n\nIn an AI context, memory allows AI tools to persist message context across interactions. This allows you to have a continuing conversations with AI agents, for example, without submitting ongoing context with each message. In n8n, AI agent nodes can use memory, but AI chains can't.\n\n#### AI retrieval-augmented generation (RAG)\n\nRetrieval-augmented generation, or RAG, is a technique for providing LLMs access to new information from external sources to improve AI responses. RAG systems retrieve relevant documents to ground responses in up-to-date, domain-specific, or proprietary knowledge to supplement their original training data. RAG systems often rely on vector stores to manage and search this external data efficiently.\n\nIn an AI context, a tool is an add-on resource that the AI can refer to for specific information or functionality when responding to a request. The AI model can use a tool to interact with external systems or complete specific, focused tasks.\n\nA vector store, or vector database, stores mathematical representations of information. Use with embeddings and retrievers to create a database that your AI can access when answering questions.\n\nAPIs, or application programming interfaces, offer programmatic access to a service's data and functionality. APIs make it easier for software to interact with external systems. They're often offered as an alternative to traditional user-focused interfaces accessed through web browsers or UI.\n\nThe canvas is the main interface for building workflows in n8n's editor UI. You use the canvas to add and connect nodes to compose workflows.\n\n#### cluster node (n8n)\n\nIn n8n, cluster nodes are groups of nodes that work together to provide functionality in a workflow. They consist of a root node and one or more sub nodes that extend the node's functionality.\n\n#### credential (n8n)\n\nIn n8n, credentials store authentication information to connect with specific apps and services. After creating credentials with your authentication information (username and password, API key, OAuth secrets, etc.), you can use the associated app node to interact with the service.\n\n#### data pinning (n8n)\n\nData pinning allows you to temporarily freeze the output data of a node during workflow development. This allows you to develop workflows with predictable data without making repeated requests to external services. Production workflows ignore pinned data and request new data on each execution.\n\nThe n8n editor UI allows you to create and manage workflows. The main area is the canvas, where you can compose workflows by adding, configuring, and connecting nodes. The side and top panels allow you to access other areas of the UI like credentials, templates, variables, executions, and more.\n\n#### entitlement (n8n)\n\nIn n8n, entitlements grant n8n instances access to plan-restricted features for a specific period of time.\n\nFloating entitlements are a pool of entitlements that you can distribute among various n8n instances. You can re-assign a floating entitlement to transfer its access to a different n8n instance.\n\n#### evaluation (n8n)\n\nIn n8n, evaluation allows you to tag and organize execution history and compare it against new executions. You can use this to understand how your workflow performs over time as you make changes. In particular, this is useful while developing AI-centered workflows.\n\n#### expression (n8n)\n\nIn n8n, expressions allow you to populate node parameters dynamically by executing JavaScript code. Instead of providing a static value, you can use the n8n expression syntax to define the value using data from previous nodes, other workflows, or your n8n environment.\n\nLangChain is an AI-development framework used to work with large language models (LLMs). LangChain provides a standardized system for working with a wide variety of models and other resources and linking different components together to build complex applications.\n\n#### Large language model (LLM)\n\nLarge language models, or LLMs, are AI machine learning models designed to excel in natural language processing (NLP) tasks. They're built by training on large amounts of data to develop probabilistic models of language and other data.\n\nIn n8n, nodes are individual components that you compose to create workflows. Nodes define when the workflow should run, allow you to fetch, send, and process data, can define flow control logic, and connect with external services.\n\nn8n projects allow you to separate workflows, variables, and credentials into separate groups for easier management. Projects make it easier for teams to collaborate by sharing and compartmentalizing related resources.\n\nEach n8n cluster node contains a single root nodes that defines the main functionality of the cluster. One or more sub nodes attach to the root node to extend its functionality.\n\nn8n cluster nodes consist of one or more sub nodes connected to a root node. Sub nodes extend the functionality of the root node, providing access to specific services or resources or offering specific types of dedicated processing, like calculator functionality, for example.\n\nn8n templates are pre-built workflows designed by n8n and community members that you can import into your n8n instance. When using templates, you may need to fill in credentials and adjust the configuration to suit your needs.\n\n#### trigger node (n8n)\n\nA trigger node is a special node responsible for executing the workflow in response to certain conditions. All production workflows need at least one trigger to determine when the workflow should run.\n\nAn n8n workflow is a collection of nodes that automate a process. Workflows begin execution when a trigger condition occurs and execute sequentially to achieve complex tasks.",
  "code_samples": [
    {
      "code": "{\n     \t\"Version\": \"2012-10-17\",\n     \t\"Statement\": [\n     \t\t{\n     \t\t\t\"Sid\": \"AccessAllSecrets\",\n     \t\t\t\"Effect\": \"Allow\",\n     \t\t\t\"Action\": [\n     \t\t\t\t\"secretsmanager:ListSecrets\",\n     \t\t\t\t\"secretsmanager:BatchGetSecretValue\",\n     \t\t\t\t\"secretsmanager:GetResourcePolicy\",\n     \t\t\t\t\"secretsmanager:GetSecretValue\",\n     \t\t\t\t\"secretsmanager:DescribeSecret\",\n     \t\t\t\t\"secretsmanager:ListSecretVersionIds\",\n     \t\t\t],\n     \t\t\t\"Resource\": \"*\"\n     \t\t}\n     \t]\n     }",
      "language": "unknown"
    },
    {
      "code": "{\n     \t\"Version\": \"2012-10-17\",\n     \t\"Statement\": [\n     \t\t{\n     \t\t\t\"Sid\": \"ListingSecrets\",\n     \t\t\t\"Effect\": \"Allow\",\n     \t\t\t\"Action\": [\n     \t\t\t\t\"secretsmanager:ListSecrets\",\n     \t\t\t\t\"secretsmanager:BatchGetSecretValue\"\n     \t\t\t],\n     \t\t\t\"Resource\": \"*\"\n     \t\t},\n     \t\t{\n     \t\t\t\"Sid\": \"RetrievingSecrets\",\n     \t\t\t\"Effect\": \"Allow\",\n     \t\t\t\"Action\": [\n     \t\t\t\t\"secretsmanager:GetSecretValue\",\n     \t\t\t\t\"secretsmanager:DescribeSecret\"\n     \t\t\t],\n     \t\t\t\"Resource\": [\n     \t\t\t\t\"arn:aws:secretsmanager:us-west-2:123456789000:secret:n8n*\"\n     \t\t\t]\n     \t\t}\n     \t]\n     }",
      "language": "unknown"
    },
    {
      "code": "{{ $secrets.<vault-name>.<secret-name> }}",
      "language": "unknown"
    }
  ],
  "headings": [
    {
      "level": "h2",
      "text": "Connect n8n to your secrets store",
      "id": "connect-n8n-to-your-secrets-store"
    },
    {
      "level": "h2",
      "text": "Use secrets in n8n credentials",
      "id": "use-secrets-in-n8n-credentials"
    },
    {
      "level": "h2",
      "text": "Using external secrets with n8n environments",
      "id": "using-external-secrets-with-n8n-environments"
    },
    {
      "level": "h2",
      "text": "Using external secrets in projects",
      "id": "using-external-secrets-in-projects"
    },
    {
      "level": "h2",
      "text": "Troubleshooting",
      "id": "troubleshooting"
    },
    {
      "level": "h3",
      "text": "Infisical version changes",
      "id": "infisical-version-changes"
    },
    {
      "level": "h3",
      "text": "Only set external secrets on credentials owned by an instance owner or admin",
      "id": "only-set-external-secrets-on-credentials-owned-by-an-instance-owner-or-admin"
    }
  ],
  "url": "llms-txt#external-secrets",
  "links": []
}