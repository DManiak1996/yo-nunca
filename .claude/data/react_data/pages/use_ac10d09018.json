{
  "url": "https://react.dev/reference/react/use",
  "title": "use",
  "content": "use is a React API that lets you read the value of a resource like a Promise or context.\n\nCall use in your component to read the value of a resource like a Promise or context.\n\nUnlike React Hooks, use can be called within loops and conditional statements like if. Like React Hooks, the function that calls use must be a Component or Hook.\n\nWhen called with a Promise, the use API integrates with Suspense and Error Boundaries. The component calling use suspends while the Promise passed to use is pending. If the component that calls use is wrapped in a Suspense boundary, the fallback will be displayed. Once the Promise is resolved, the Suspense fallback is replaced by the rendered components using the data returned by the use API. If the Promise passed to use is rejected, the fallback of the nearest Error Boundary will be displayed.\n\nSee more examples below.\n\nThe use API returns the value that was read from the resource like the resolved value of a Promise or context.\n\nWhen a context is passed to use, it works similarly to useContext. While useContext must be called at the top level of your component, use can be called inside conditionals like if and loops like for. use is preferred over useContext because it is more flexible.\n\nuse returns the context value for the context you passed. To determine the context value, React searches the component tree and finds the closest context provider above for that particular context.\n\nTo pass context to a Button, wrap it or one of its parent components into the corresponding context provider.\n\nIt doesn’t matter how many layers of components there are between the provider and the Button. When a Button anywhere inside of Form calls use(ThemeContext), it will receive \"dark\" as the value.\n\nUnlike useContext, use can be called in conditionals and loops like if.\n\nuse is called from inside a if statement, allowing you to conditionally read values from a Context.\n\nLike useContext, use(context) always looks for the closest context provider above the component that calls it. It searches upwards and does not consider context providers in the component from which you’re calling use(context).\n\nData can be streamed from the server to the client by passing a Promise as a prop from a Server Component to a Client Component.\n\nThe Client Component then takes the Promise it received as a prop and passes it to the use API. This allows the Client Component to read the value from the Promise that was initially created by the Server Component.\n\nBecause Message is wrapped in Suspense, the fallback will be displayed until the Promise is resolved. When the Promise is resolved, the value will be read by the use API and the Message component will replace the Suspense fallback.\n\nWhen passing a Promise from a Server Component to a Client Component, its resolved value must be serializable to pass between server and client. Data types like functions aren’t serializable and cannot be the resolved value of such a Promise.\n\nA Promise can be passed from a Server Component to a Client Component and resolved in the Client Component with the use API. You can also resolve the Promise in a Server Component with await and pass the required data to the Client Component as a prop.\n\nBut using await in a Server Component will block its rendering until the await statement is finished. Passing a Promise from a Server Component to a Client Component prevents the Promise from blocking the rendering of the Server Component.\n\nIn some cases a Promise passed to use could be rejected. You can handle rejected Promises by either:\n\nuse cannot be called in a try-catch block. Instead of a try-catch block wrap your component in an Error Boundary, or provide an alternative value to use with the Promise’s .catch method.\n\nIf you’d like to display an error to your users when a Promise is rejected, you can use an Error Boundary. To use an Error Boundary, wrap the component where you are calling the use API in an Error Boundary. If the Promise passed to use is rejected the fallback for the Error Boundary will be displayed.\n\nIf you’d like to provide an alternative value when the Promise passed to use is rejected you can use the Promise’s catch method.\n\nTo use the Promise’s catch method, call catch on the Promise object. catch takes a single argument: a function that takes an error message as an argument. Whatever is returned by the function passed to catch will be used as the resolved value of the Promise.\n\nYou are either calling use outside of a React Component or Hook function, or calling use in a try–catch block. If you are calling use inside a try–catch block, wrap your component in an Error Boundary, or call the Promise’s catch to catch the error and resolve the Promise with another value. See these examples.\n\nIf you are calling use outside a React Component or Hook function, move the use call to a React Component or Hook function.\n\nInstead, call use outside any component closures, where the function that calls use is a Component or Hook.",
  "headings": [
    {
      "level": "h1",
      "text": "use",
      "id": ""
    },
    {
      "level": "h2",
      "text": "Reference",
      "id": "reference"
    },
    {
      "level": "h3",
      "text": "use(resource)",
      "id": "use"
    },
    {
      "level": "h4",
      "text": "Parameters",
      "id": "parameters"
    },
    {
      "level": "h4",
      "text": "Returns",
      "id": "returns"
    },
    {
      "level": "h4",
      "text": "Caveats",
      "id": "caveats"
    },
    {
      "level": "h2",
      "text": "Usage",
      "id": "usage"
    },
    {
      "level": "h3",
      "text": "Reading context with use",
      "id": "reading-context-with-use"
    },
    {
      "level": "h3",
      "text": "Pitfall",
      "id": ""
    },
    {
      "level": "h3",
      "text": "Streaming data from the server to the client",
      "id": "streaming-data-from-server-to-client"
    },
    {
      "level": "h3",
      "text": "Note",
      "id": ""
    },
    {
      "level": "h5",
      "text": "Deep Dive",
      "id": ""
    },
    {
      "level": "h4",
      "text": "Should I resolve a Promise in a Server or Client Component?",
      "id": "resolve-promise-in-server-or-client-component"
    },
    {
      "level": "h3",
      "text": "Dealing with rejected Promises",
      "id": "dealing-with-rejected-promises"
    },
    {
      "level": "h3",
      "text": "Pitfall",
      "id": ""
    },
    {
      "level": "h4",
      "text": "Displaying an error to users with an Error Boundary",
      "id": "displaying-an-error-to-users-with-error-boundary"
    },
    {
      "level": "h4",
      "text": "Providing an alternative value with Promise.catch",
      "id": "providing-an-alternative-value-with-promise-catch"
    },
    {
      "level": "h2",
      "text": "Troubleshooting",
      "id": "troubleshooting"
    },
    {
      "level": "h3",
      "text": "“Suspense Exception: This is not a real error!”",
      "id": "suspense-exception-error"
    }
  ],
  "code_samples": [
    {
      "code": "const value = use(resource);",
      "language": "javascript"
    },
    {
      "code": "import { use } from 'react';function MessageComponent({ messagePromise }) {  const message = use(messagePromise);  const theme = use(ThemeContext);  // ...",
      "language": "python"
    },
    {
      "code": "import { use } from 'react';function Button() {  const theme = use(ThemeContext);  // ...",
      "language": "python"
    },
    {
      "code": "function MyPage() {  return (    <ThemeContext value=\"dark\">      <Form />    </ThemeContext>  );}function Form() {  // ... renders buttons inside ...}",
      "language": "unknown"
    },
    {
      "code": "function HorizontalRule({ show }) {  if (show) {    const theme = use(ThemeContext);    return <hr className={theme} />;  }  return false;}",
      "language": "javascript"
    },
    {
      "code": "import { fetchMessage } from './lib.js';import { Message } from './message.js';export default function App() {  const messagePromise = fetchMessage();  return (    <Suspense fallback={<p>waiting for message...</p>}>      <Message messagePromise={messagePromise} />    </Suspense>  );}",
      "language": "python"
    },
    {
      "code": "// message.js'use client';import { use } from 'react';export function Message({ messagePromise }) {  const messageContent = use(messagePromise);  return <p>Here is the message: {messageContent}</p>;}",
      "language": "python"
    },
    {
      "code": "export default async function App() {  const messageContent = await fetchMessage();  return <Message messageContent={messageContent} />}",
      "language": "javascript"
    },
    {
      "code": "import { Message } from './message.js';export default function App() {  const messagePromise = new Promise((resolve, reject) => {    reject();  }).catch(() => {    return \"no new message found.\";  });  return (    <Suspense fallback={<p>waiting for message...</p>}>      <Message messagePromise={messagePromise} />    </Suspense>  );}",
      "language": "python"
    },
    {
      "code": "function MessageComponent({messagePromise}) {  function download() {    // ❌ the function calling `use` is not a Component or Hook    const message = use(messagePromise);    // ...",
      "language": "javascript"
    },
    {
      "code": "function MessageComponent({messagePromise}) {  // ✅ `use` is being called from a component.   const message = use(messagePromise);  // ...",
      "language": "javascript"
    }
  ],
  "patterns": [],
  "links": [
    "https://react.dev/reference/react",
    "https://react.dev/reference/react/apis",
    "https://react.dev/reference/react/use",
    "https://react.dev/learn/passing-data-deeply-with-context",
    "https://react.dev/reference/react/Suspense",
    "https://react.dev/reference/react/Component",
    "https://react.dev/reference/rsc/server-components",
    "https://react.dev/reference/rsc/use-client",
    "https://react.dev/reference/react/useContext",
    "https://react.dev/reference/react/startTransition",
    "https://react.dev/reference/react/experimental_taintObjectReference"
  ]
}