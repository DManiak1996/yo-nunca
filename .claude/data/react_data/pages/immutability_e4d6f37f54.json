{
  "url": "https://react.dev/reference/eslint-plugin-react-hooks/lints/immutability",
  "title": "immutability",
  "content": "Validates against mutating props, state, and other values that are immutable.\n\nA component’s props and state are immutable snapshots. Never mutate them directly. Instead, pass new props down, and use the setter function from useState.\n\nMutating arrays with methods like push() won’t trigger re-renders:\n\nCreate a new array instead:\n\nMutating nested properties doesn’t trigger re-renders:\n\nSpread at each level that needs updating:",
  "headings": [
    {
      "level": "h1",
      "text": "immutability",
      "id": ""
    },
    {
      "level": "h2",
      "text": "Rule Details",
      "id": "rule-details"
    },
    {
      "level": "h2",
      "text": "Common Violations",
      "id": "common-violations"
    },
    {
      "level": "h3",
      "text": "Invalid",
      "id": "invalid"
    },
    {
      "level": "h3",
      "text": "Valid",
      "id": "valid"
    },
    {
      "level": "h2",
      "text": "Troubleshooting",
      "id": "troubleshooting"
    },
    {
      "level": "h3",
      "text": "I need to add items to an array",
      "id": "add-items-array"
    },
    {
      "level": "h3",
      "text": "I need to update nested objects",
      "id": "update-nested-objects"
    }
  ],
  "code_samples": [
    {
      "code": "// ❌ Array push mutationfunction Component() {  const [items, setItems] = useState([1, 2, 3]);  const addItem = () => {    items.push(4); // Mutating!    setItems(items); // Same reference, no re-render  };}// ❌ Object property assignmentfunction Component() {  const [user, setUser] = useState({name: 'Alice'});  const updateName = () => {    user.name = 'Bob'; // Mutating!    setUser(user); // Same reference  };}// ❌ Sort without spreadingfunction Component() {  const [items, setItems] = useState([3, 1, 2]);  const sortItems = () => {    setItems(items.sort()); // sort mutates!  };}",
      "language": "javascript"
    },
    {
      "code": "// ✅ Create new arrayfunction Component() {  const [items, setItems] = useState([1, 2, 3]);  const addItem = () => {    setItems([...items, 4]); // New array  };}// ✅ Create new objectfunction Component() {  const [user, setUser] = useState({name: 'Alice'});  const updateName = () => {    setUser({...user, name: 'Bob'}); // New object  };}",
      "language": "javascript"
    },
    {
      "code": "// ❌ Wrong: Mutating the arrayfunction TodoList() {  const [todos, setTodos] = useState([]);  const addTodo = (id, text) => {    todos.push({id, text});    setTodos(todos); // Same array reference!  };  return (    <ul>      {todos.map(todo => <li key={todo.id}>{todo.text}</li>)}    </ul>  );}",
      "language": "javascript"
    },
    {
      "code": "// ✅ Better: Create a new arrayfunction TodoList() {  const [todos, setTodos] = useState([]);  const addTodo = (id, text) => {    setTodos([...todos, {id, text}]);    // Or: setTodos(todos => [...todos, {id: Date.now(), text}])  };  return (    <ul>      {todos.map(todo => <li key={todo.id}>{todo.text}</li>)}    </ul>  );}",
      "language": "javascript"
    },
    {
      "code": "// ❌ Wrong: Mutating nested objectfunction UserProfile() {  const [user, setUser] = useState({    name: 'Alice',    settings: {      theme: 'light',      notifications: true    }  });  const toggleTheme = () => {    user.settings.theme = 'dark'; // Mutation!    setUser(user); // Same object reference  };}",
      "language": "javascript"
    },
    {
      "code": "// ✅ Better: Create new objects at each levelfunction UserProfile() {  const [user, setUser] = useState({    name: 'Alice',    settings: {      theme: 'light',      notifications: true    }  });  const toggleTheme = () => {    setUser({      ...user,      settings: {        ...user.settings,        theme: 'dark'      }    });  };}",
      "language": "javascript"
    }
  ],
  "patterns": [],
  "links": [
    "https://react.dev/reference/react",
    "https://react.dev/reference/eslint-plugin-react-hooks",
    "https://react.dev/reference/eslint-plugin-react-hooks/lints/immutability",
    "https://react.dev/reference/rules/components-and-hooks-must-be-pure",
    "https://react.dev/reference/eslint-plugin-react-hooks/lints/globals",
    "https://react.dev/reference/eslint-plugin-react-hooks/lints/incompatible-library"
  ]
}