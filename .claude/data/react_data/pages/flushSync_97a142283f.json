{
  "url": "https://react.dev/reference/react-dom/flushSync",
  "title": "flushSync",
  "content": "Using flushSync is uncommon and can hurt the performance of your app.\n\nflushSync lets you force React to flush any updates inside the provided callback synchronously. This ensures that the DOM is updated immediately.\n\nCall flushSync to force React to flush any pending work and update the DOM synchronously.\n\nMost of the time, flushSync can be avoided. Use flushSync as last resort.\n\nSee more examples below.\n\nflushSync returns undefined.\n\nWhen integrating with third-party code such as browser APIs or UI libraries, it may be necessary to force React to flush updates. Use flushSync to force React to flush any state updates inside the callback synchronously:\n\nThis ensures that, by the time the next line of code runs, React has already updated the DOM.\n\nUsing flushSync is uncommon, and using it often can significantly hurt the performance of your app. If your app only uses React APIs, and does not integrate with third-party libraries, flushSync should be unnecessary.\n\nHowever, it can be helpful for integrating with third-party code like browser APIs.\n\nSome browser APIs expect results inside of callbacks to be written to the DOM synchronously, by the end of the callback, so the browser can do something with the rendered DOM. In most cases, React handles this for you automatically. But in some cases it may be necessary to force a synchronous update.\n\nFor example, the browser onbeforeprint API allows you to change the page immediately before the print dialog opens. This is useful for applying custom print styles that allow the document to display better for printing. In the example below, you use flushSync inside of the onbeforeprint callback to immediately â€œflushâ€ the React state to the DOM. Then, by the time the print dialog opens, isPrinting displays â€œyesâ€:\n\nWithout flushSync, the print dialog will display isPrinting as â€œnoâ€. This is because React batches the updates asynchronously and the print dialog is displayed before the state is updated.\n\nflushSync can significantly hurt performance, and may unexpectedly force pending Suspense boundaries to show their fallback state.\n\nMost of the time, flushSync can be avoided, so use flushSync as a last resort.\n\nReact cannot flushSync in the middle of a render. If you do, it will noop and warn:\n\nThis includes calling flushSync inside:\n\nFor example, calling flushSync in an Effect will noop and warn:\n\nTo fix this, you usually want to move the flushSync call to an event:\n\nIf itâ€™s difficult to move to an event, you can defer flushSync in a microtask:\n\nThis will allow the current render to finish and schedule another syncronous render to flush the updates.\n\nflushSync can significantly hurt performance, but this particular pattern is even worse for performance. Exhaust all other options before calling flushSync in a microtask as an escape hatch.",
  "headings": [
    {
      "level": "h1",
      "text": "flushSync",
      "id": ""
    },
    {
      "level": "h3",
      "text": "Pitfall",
      "id": ""
    },
    {
      "level": "h2",
      "text": "Reference",
      "id": "reference"
    },
    {
      "level": "h3",
      "text": "flushSync(callback)",
      "id": "flushsync"
    },
    {
      "level": "h4",
      "text": "Parameters",
      "id": "parameters"
    },
    {
      "level": "h4",
      "text": "Returns",
      "id": "returns"
    },
    {
      "level": "h4",
      "text": "Caveats",
      "id": "caveats"
    },
    {
      "level": "h2",
      "text": "Usage",
      "id": "usage"
    },
    {
      "level": "h3",
      "text": "Flushing updates for third-party integrations",
      "id": "flushing-updates-for-third-party-integrations"
    },
    {
      "level": "h3",
      "text": "Pitfall",
      "id": ""
    },
    {
      "level": "h2",
      "text": "Troubleshooting",
      "id": "troubleshooting"
    },
    {
      "level": "h3",
      "text": "Iâ€™m getting an error: â€œflushSync was called from inside a lifecycle methodâ€",
      "id": "im-getting-an-error-flushsync-was-called-from-inside-a-lifecycle-method"
    },
    {
      "level": "h3",
      "text": "Pitfall",
      "id": ""
    }
  ],
  "code_samples": [
    {
      "code": "flushSync(callback)",
      "language": "unknown"
    },
    {
      "code": "import { flushSync } from 'react-dom';flushSync(() => {  setSomething(123);});",
      "language": "python"
    },
    {
      "code": "flushSync(() => {  setSomething(123);});// By this line, the DOM is updated.",
      "language": "javascript"
    },
    {
      "code": "import { useEffect } from 'react';import { flushSync } from 'react-dom';function MyComponent() {  useEffect(() => {    // ðŸš© Wrong: calling flushSync inside an effect    flushSync(() => {      setSomething(newValue);    });  }, []);  return <div>{/* ... */}</div>;}",
      "language": "python"
    },
    {
      "code": "function handleClick() {  // âœ… Correct: flushSync in event handlers is safe  flushSync(() => {    setSomething(newValue);  });}",
      "language": "javascript"
    },
    {
      "code": "useEffect(() => {  // âœ… Correct: defer flushSync to a microtask  queueMicrotask(() => {    flushSync(() => {      setSomething(newValue);    });  });}, []);",
      "language": "javascript"
    }
  ],
  "patterns": [],
  "links": [
    "https://react.dev/reference/react",
    "https://react.dev/reference/react-dom",
    "https://react.dev/reference/react-dom/flushSync",
    "https://react.dev/reference/react-dom/createPortal",
    "https://react.dev/reference/react-dom/preconnect"
  ]
}